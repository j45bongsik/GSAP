<!DOCTYPE html>
<html lang="ko">
<head>
    @@include('include/head.html') 
    <style>
        .parallax__item__title {
            font-size: 5vw;
            z-index: 100;
            text-transform: uppercase;
            display: inline-block;
        }
        
    </style>
    <title>Title</title>
</head>
<body>
    <div id="root">
        <!--header-->
        <header id="header" class="parallax__title">
            <!-- @@include('include/header.html') -->
            <h1>GSAP Parallax Effect03</h1>
            <p>GSAP scrollTrigger - 배경 고정하기</p>
            
            <article>
                <ul>
                    <li><a href="gsap01.html">1</a></li>
                    <li><a href="gsap02.html">2</a></li>
                    <li class="active"><a href="gsap03.html">3</a></li>
                    <li><a href="gsap04.html">4</a></li>
                    <li><a href="gsap05.html">5</a></li>
                    <li><a href="gsap06.html">6</a></li>
                    <li><a href="gsap07.html">7</a></li>
                    <li><a href="gsap08.html">8</a></li>
                    <li><a href="gsap09.html">9</a></li>
                    <li><a href="gsap10.html">10</a></li>
                    <li><a href="gsap11.html">11</a></li>
                    <li><a href="gsap12.html">12</a></li>
                    <li><a href="gsap13.html">13</a></li>
                    <li><a href="gsap14.html">14</a></li>
                    <li><a href="gsap15.html">15</a></li>
                </ul>
            </article>

        </header>
        <!--header-->

        <!--container-->
        <main id="parallax__cont">

            
            <section id="section1" class="parallax__item">
                <span class="parallax__item__num">panel 애니메이션
                    <span class="parallax__item__desc">
                        https://webstoryboy.co.kr/1911 참고

                    </span>
                </span>
                <div class="parallax__item__img"></div>

                <article class="js navi-js">
                    <pre class="brush:js">
                        //01 : panel 애니메이션 - 한개섹션 고정시키기
                        const panel = document.querySelector("#section1");

                        ScrollTrigger.create({
                            trigger: panel,
                            start: "top top",
                            pin: true,
                            pinSpacing: false
                        });
                

                        //02 : panel 애니메이션 - 지정한 섹션만 고정시키기
                        gsap.utils.toArray(".parallax__item").forEach((panel, i) => {
                            if ([0, 3, 6, 7].includes(i)) { // Only pin specified sections
                                ScrollTrigger.create({
                                trigger: panel,
                                start: "top top",
                                pin: true,
                                pinSpacing: false
                                });
                            }
                        });

                        //03 : panel 애니메이션 - 홀수or짝수 섹션만 고정시키기
                        gsap.utils.toArray(".parallax__item").forEach((panel, i) => {
                            // if (i % 2 !== 0) { // 홀수
                            if (i % 2 === 0) { // 짝수
                                ScrollTrigger.create({
                                trigger: panel,
                                start: "top top",
                                pin: true,
                                pinSpacing: false
                                });
                            }
                        });

                    </pre>
                </article>
                <h2 class="parallax__item__title">section1</h2>
            </section>
            <!-- //section1 -->
    
            <section id="section2" class="parallax__item">
                <span class="parallax__item__num">02</span>
                <div class="parallax__item__img"></div>
                <article class="js navi-js">
                    <pre class="brush:js">
                        
                        //04 : panel 애니메이션 - 전체 섹션 고정시키기
                        gsap.utils.toArray(".parallax__item").forEach((panel, i) => {
                            ScrollTrigger.create({
                                trigger: panel,
                                start: "top top",
                                pin: true, 
                                pinSpacing: false 
                            });
                        });

                        //05 : panel 애니메이션 - 스냅 효과 적용
                        let panels = gsap.utils.toArray(".parallax__item");
                        let tops = panels.map(panel => ScrollTrigger.create({trigger: panel, start: "top top"}));

                        panels.forEach((panel, i) => {
                            ScrollTrigger.create({
                                trigger: panel,
                                start: () => panel.offsetHeight < window.innerHeight ? "top top" : "bottom bottom",
                                pin: true, 
                                pinSpacing: false 
                            });
                        });

                        ScrollTrigger.create({
                            snap: {
                                snapTo: (progress, self) => {
                                    let panelStarts = tops.map(st => st.start), 
                                    snapScroll = gsap.utils.snap(panelStarts, self.scroll()); 
                                    return gsap.utils.normalize(0, ScrollTrigger.maxScroll(window), snapScroll); 
                                },
                                duration: 0.5
                            }
                        });
                    </pre>
                </article>
                <h2 class="parallax__item__title">section2</h2>
            </section>
            <!-- //section2 -->
    
            <section id="section3" class="parallax__item">
                <span class="parallax__item__num">03</span>
                <div class="parallax__item__img"></div>
                <h2 class="parallax__item__title">section3</h2>
            </section>
            <!-- //section3 -->
    
            <section id="section4" class="parallax__item">
                <span class="parallax__item__num">04</span>
                <div class="parallax__item__img"></div>
                <h2 class="parallax__item__title">section4</h2>
            </section>
            <!-- //section4 -->
    
            <section id="section5" class="parallax__item">
                <span class="parallax__item__num">05</span>
                <div class="parallax__item__img"></div>
                <h2 class="parallax__item__title">section5</h2>
            </section>
            <!-- //section5 -->
    
            <section id="section6" class="parallax__item">
                <span class="parallax__item__num">06</span>
                <div class="parallax__item__img"></div>
                <h2 class="parallax__item__title">section6</h2>
            </section>
            <!-- //section6 -->
    
            <section id="section7" class="parallax__item">
                <span class="parallax__item__num">07</span>
                <div class="parallax__item__img"></div>
                <h2 class="parallax__item__title">section7</h2>
            </section>
            <!-- //section7 -->
    
            <section id="section8" class="parallax__item">
                <span class="parallax__item__num">08</span>
                <div class="parallax__item__img"></div>
                <h2 class="parallax__item__title">section8</h2>
            </section>
            <!-- //section8 -->
    
            <section id="section9" class="parallax__item">
                <span class="parallax__item__num">09</span>
                <div class="parallax__item__img"></div>
                <h2 class="parallax__item__title">section9</h2>
            </section>
            <!-- //section9 -->
        </main>
        <!--//container-->

        <script>
            
            // //01 : panel 애니메이션 - 한개섹션 고정시키기
            // const panel = document.querySelector("#section1");

            // ScrollTrigger.create({
            //     trigger: panel,
            //     start: "top top",
            //     pin: true,
            //     pinSpacing: false
            // });
       

            // //02 : panel 애니메이션 - 지정한 섹션만 고정시키기
            // gsap.utils.toArray(".parallax__item").forEach((panel, i) => {
            //     if ([0, 3, 6, 7].includes(i)) { // Only pin specified sections
            //         ScrollTrigger.create({
            //         trigger: panel,
            //         start: "top top",
            //         pin: true,
            //         pinSpacing: false
            //         });
            //     }
            // });

            // //03 : panel 애니메이션 - 홀수or짝수 섹션만 고정시키기
            // gsap.utils.toArray(".parallax__item").forEach((panel, i) => {
            //     // if (i % 2 !== 0) { // 홀수
            //     if (i % 2 === 0) { // 짝수
            //         ScrollTrigger.create({
            //         trigger: panel,
            //         start: "top top",
            //         pin: true,
            //         pinSpacing: false
            //         });
            //     }
            // });

            // //04 : panel 애니메이션 - 전체 섹션 고정시키기
            // gsap.utils.toArray(".parallax__item").forEach((panel, i) => {
            //     ScrollTrigger.create({
            //         trigger: panel,
            //         start: "top top",
            //         pin: true, 
            //         pinSpacing: false 
            //     });
            // });

            //05 : panel 애니메이션 - 스냅 효과 적용
            let panels = gsap.utils.toArray(".parallax__item");
            let tops = panels.map(panel => ScrollTrigger.create({trigger: panel, start: "top top"}));

            panels.forEach((panel, i) => {
                ScrollTrigger.create({
                    trigger: panel,
                    start: () => panel.offsetHeight < window.innerHeight ? "top top" : "bottom bottom",
                    pin: true, 
                    pinSpacing: false 
                });
            });

            ScrollTrigger.create({
                snap: {
                    snapTo: (progress, self) => {
                        let panelStarts = tops.map(st => st.start), 
                        snapScroll = gsap.utils.snap(panelStarts, self.scroll()); 
                        return gsap.utils.normalize(0, ScrollTrigger.maxScroll(window), snapScroll); 
                    },
                    duration: 0.5
                }
            });

        </script>

        
        <!--footer-->
        <footer id="footer">
            @@include('include/footer.html')
        </footer>
        <!--//footer-->
    </div>
</body>
</html>